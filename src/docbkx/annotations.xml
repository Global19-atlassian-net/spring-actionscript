<?xml version="1.0" encoding="UTF-8"?>
<chapter annotations="" version="5.0" xml:id="annotations"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xs="http://www.w3.org/2001/XMLSchema"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:ns5="http://www.w3.org/1998/Math/MathML"
         xmlns:ns4="http://www.w3.org/2000/svg"
         xmlns:ns3="http://www.w3.org/1999/xhtml"
         xmlns:ns="http://docbook.org/ns/docbook">
  <title>Metadata annotations handling</title>

  <section xml:id="metadata_handling_introduction">
    <title>Introduction</title>

    <para>Spring Actionscript offers an easy way to process actionscript
    metadata annotations. The main interface of interest for this task is
    <literal
    xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor">IMetadataProcessor</literal>.</para>

    <para>Here's what it looks like up close:</para>

    <programlisting>public interface IMetadataProcessor {

 function get metadataNames():Array;

 function get processBeforeInitialization():Boolean;

 function process(instance:Object, container:IMetaDataContainer, name:String, objectName:String):void;
}</programlisting>

    <para>The basic properties have already been implemented by the <literal
    xlink:href="asdoc://org.springextensions.actionscript.metadata.AbstractMetadataProcessor">AbstractMetadataProcessor</literal>
    base class which can be used for convenience.</para>

    <para>Let's take a look at the various properties and methods and see what
    they do and mean.</para>

    <itemizedlist>
      <listitem>
        <para><literal
        xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor#metadataNames()">metadataNames</literal>
        - This is an Array of metadata names that will trigger the process()
        method of the <literal
        xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor">IMetadataProcessor</literal>
        implementation.</para>
      </listitem>

      <listitem>
        <para><literal
        xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor#processBeforeInitialization()">processBeforeInitialization</literal>
        - When set to <emphasis role="bold">true</emphasis> the <literal
        xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor">IMetadataProcessor</literal>
        instance will be able to process the annotated instance before it has
        been initialized by the Spring Actionscript container.</para>
      </listitem>

      <listitem>
        <para><literal
        xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor#process()">process</literal>
        - This method will contain the processing logic that is associated
        with the various names specified by the <literal
        xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor#metadataNames()">metadataNames</literal>
        property.</para>
      </listitem>
    </itemizedlist>

    <para>The <literal
    xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor#process()">process()</literal>
    method will naturally be the most important aspect in any implementation
    of the <literal
    xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor">IMetadataProcessor</literal>
    interface. It receives three parameters:</para>

    <itemizedlist>
      <listitem>
        <para>instance - This is the object instance that was encountered with
        the specified metadata name on its class or its methods or
        properties.</para>
      </listitem>

      <listitem>
        <para>container - The IMetaDataContainer that is associated with the
        instance, this can be any of these subclasses: Type, Method, Accessor,
        Constant, Variable.</para>
      </listitem>

      <listitem>
        <para>name - The metadata name that triggered the invocation of the
        <literal
        xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor#process()">process()</literal>
        method.</para>
      </listitem>

      <listitem>
        <para>objectName - The name of the object definition in the Spring
        Actionscript container.</para>
      </listitem>
    </itemizedlist>

    <para>To use the <literal
    xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor">IMetadataProcessor</literal>
    in an application add the implementation as an object definition to the
    application context configuration like this:</para>

    <programlisting>&lt;object id="mvcEventsProcessor" class="org.springextensions.actionscript.core.mvc.MVCRouteEventsMetaDataProcessor"/&gt;</programlisting>

    <para>After that the processor is ready to go, when used in combination
    with the autowiring stage processor (as described in <literal
    linkend="autowiring_stage_components">this section</literal>) it will
    process both objects created by the container and components that were
    added to the stage.</para>

    <note>
      <para>Credit where credit is due: This type of metadata handling is
      similar to the <literal
      xlink:href="http://www.spicefactory.org/parsley/docs/2.3/api/parsley-flex/org/spicefactory/parsley/config/ObjectDefinitionDecorator.html">ObjectDefinitionDecorator</literal>
      in the <literal
      xlink:href="http://www.spicefactory.org/parsley/">Parsley
      Framework</literal> and the IMetadataProcessor in the <literal
      xlink:href="http://www.swizframework.org">Swiz Framework</literal>, the
      Spring Actionscript team both acknowledges and appreciates this work.
      Java programmers will see the obvious similarities with the <literal
      xlink:href="http://download.oracle.com/javase/1.5.0/docs/guide/apt/mirror/com/sun/mirror/apt/AnnotationProcessor.html">Java
      annotation processor</literal>.</para>
    </note>

    <section>
      <title>Controlling the order of IMetadataProcessors</title>

      <para>The order in which <literal
      xlink:href="asdoc://org.springextensions.actionscript.metadata.IMetadataProcessor">IMetadataProcessors</literal>
      are executed is controlled by the <literal
      xlink:href="asdoc://org.springextensions.actionscript.core.IOrdered">IOrdered</literal>
      interface. See the '<link
      linkend="controlling_collection_order">Controlling collection
      order</link>' section for more information on this interface.</para>
    </section>
  </section>
</chapter>
